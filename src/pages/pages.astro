---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const entries = await getCollection('pages', ({ data }) => !data.draft);
entries.sort((a, b) => {
  const orderDiff = (a.data.navOrder ?? 100) - (b.data.navOrder ?? 100);
  if (orderDiff !== 0) return orderDiff;
  return a.data.title.localeCompare(b.data.title);
});
---

<Layout title="Pages | Vibe AI Infra" description="Markdown-driven subpages for Vibe AI Infra">
  <main class="pages-shell reveal">
    <header class="pages-header">
      <span class="eyebrow">Content Hub</span>
      <h1>Markdown Pages</h1>
      <p>
        Add files under <code>src/content/pages/</code> to create new subpages.
      </p>
    </header>

    <section class="pages-grid">
      {entries.map((entry) => (
        <a class="page-card" href={`/${entry.slug}`}>
          <h2>{entry.data.navLabel ?? entry.data.title}</h2>
          <p>{entry.data.summary ?? entry.data.description ?? 'No description yet.'}</p>
          <span class="jump">Open page</span>
        </a>
      ))}
    </section>
  </main>
</Layout>

<style>
  .pages-shell {
    max-width: 1100px;
    margin: 0 auto;
    padding: 56px 20px 100px;
  }

  .pages-header {
    max-width: 720px;
    margin-bottom: 28px;
  }

  .eyebrow {
    display: inline-block;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--muted);
    font-size: 0.72rem;
  }

  h1 {
    font-family: var(--font-display);
    letter-spacing: -0.02em;
    line-height: 1.05;
    font-size: clamp(2.1rem, 5vw, 3.2rem);
  }

  .pages-header p {
    margin-top: 12px;
    color: var(--muted);
    font-size: 1.02rem;
  }

  .pages-header code {
    background: #e7efe6;
    border-radius: 5px;
    padding: 0.1rem 0.35rem;
  }

  .pages-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 16px;
    margin-top: 26px;
  }

  .page-card {
    background: var(--surface);
    border: 1px solid var(--line);
    border-radius: 14px;
    padding: 20px;
    transition: transform 180ms ease, border-color 180ms ease, box-shadow 180ms ease;
  }

  .page-card:hover {
    transform: translateY(-2px);
    border-color: var(--accent);
    box-shadow: 0 10px 24px rgba(9, 55, 61, 0.1);
  }

  h2 {
    font-family: var(--font-display);
    letter-spacing: -0.01em;
    font-size: 1.15rem;
  }

  .page-card p {
    margin-top: 8px;
    color: var(--muted);
    font-size: 0.94rem;
    line-height: 1.6;
  }

  .jump {
    display: inline-flex;
    margin-top: 14px;
    font-size: 0.85rem;
    color: var(--accent);
    font-weight: 600;
  }
</style>
